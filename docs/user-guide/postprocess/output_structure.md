# Postprocessing Output Structure

When you run the `canari_ml postprocess` command, the output can be found under the `outputs/` directory by default. The final postprocessing results include netCDF files containing the processed predictions, ready for analysis or visualisation. In the future, this postprocessing step can include other options than just generating a netCDF.

---

## Overview

The postprocessing pipeline performs the following key steps:

- Takes the raw model predictions generated by the `canari_ml predict` command.
- Processes (convert change of state of `ua700` to actual normalised `ua700` for each date) then denormalises the raw predictions.
- Saves the processed predictions into `.nc` (netCDF), for easy access and analysis.
- Organises the processed outputs into a dedicated folder structure under `results/`.

---

## Simplified Output Tree

The main output directory is the same as the prediction step.

```console
outputs/
└── demo_train/                     # Parent directory corresponding to the training run
    └── prediction/
        └── 1979-01-26/             # Prediction name
            └── 42/
                ├── predict_2025-09-16_11-52-38.log  # Postprocess log
                └── results/
                    └── postprocess/
                        └── netcdf/
                            └── prediction_file.nc  # Processed predictions in netCDF format
```

Where:

- `postprocess/netcdf/` contains the final processed predictions in netCDF format.

### Output Breakdown

`prediction/<predict.name>/results/postprocess/netcdf/`

- The postprocessed prediction results are stored in this directory. The `netcdf/` subfolder contains the processed predictions in netCDF format.
- `prediction_file.nc` is the default netCDF output filename.
- If an ensemble run, this will contain the ensemble mean and standard deviation.
- The data in this file corresponds to the model’s forecast for the specified date(s) (only `1979-01-26` in this example).

---

## Summary

After running the `canari_ml postprocess` command:

- The postprocessed prediction results are placed under `outputs/<train.name>/prediction/<predict.name>/results/postprocess/netcdf/`.
- netCDF files are generated, containing processed model outputs, ready for analysis.
